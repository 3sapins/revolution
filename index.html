<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>J'ai v√©cu la R√©volution fran√ßaise</title>
    <link href="https://fonts.googleapis.com/css2?family=Cinzel:wght@400;700;900&family=EB+Garamond:ital,wght@0,400;0,600;1,400&family=UnifrakturMaguntia&display=swap" rel="stylesheet">
    <style>
        :root {
            --bleu-roi: #002654;
            --blanc-royal: #f5f0e6;
            --rouge-sang: #a41c1c;
            --or-ancien: #c9a227;
            --parchemin: #f4edd3;
            --encre: #1a1a1a;
            --sepia: #704214;
            --rouge-bonnet: #c41e3a;
            --bleu-liberte: #1e3a5f;
        }
        * { box-sizing: border-box; margin: 0; padding: 0; }
        @keyframes fadeInUp {
            from { opacity: 0; transform: translateY(30px); }
            to { opacity: 1; transform: translateY(0); }
        }
        body {
            min-height: 100vh;
            background: var(--parchemin);
            font-family: 'EB Garamond', Georgia, serif;
            color: var(--encre);
            line-height: 1.7;
        }
        body::before {
            content: '';
            position: fixed;
            top: 0; left: 0; right: 0; bottom: 0;
            border: 12px solid transparent;
            border-image: repeating-linear-gradient(45deg, var(--bleu-roi) 0px, var(--bleu-roi) 10px, var(--blanc-royal) 10px, var(--blanc-royal) 20px, var(--rouge-sang) 20px, var(--rouge-sang) 30px) 12;
            pointer-events: none;
            z-index: 1000;
        }
        .hidden { display: none !important; }
        .score-bar {
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            display: flex;
            justify-content: center;
            gap: 0.8rem;
            padding: 0.6rem 1.5rem;
            background: linear-gradient(180deg, #2a2a2a 0%, var(--encre) 100%);
            border-top: 3px solid var(--or-ancien);
            z-index: 999;
            box-shadow: 0 -4px 20px rgba(0,0,0,0.4);
        }
        .score-item {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 0.2rem;
            padding: 0.3rem 0.5rem;
            min-width: 70px;
        }
        .score-item-header {
            display: flex;
            align-items: center;
            gap: 0.3rem;
            font-family: 'Cinzel', serif;
            font-size: 0.7rem;
            font-weight: 700;
            color: var(--blanc-royal);
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }
        .score-item-header .emoji { font-size: 1rem; }
        .gauge-container {
            width: 100%;
            height: 10px;
            background: rgba(255,255,255,0.15);
            border-radius: 5px;
            overflow: hidden;
            border: 1px solid rgba(255,255,255,0.2);
        }
        .gauge-fill {
            height: 100%;
            border-radius: 5px;
            transition: width 0.5s ease;
            width: 0%;
        }
        .gauge-fill.royaliste { background: linear-gradient(90deg, #ccc, #fff); }
        .gauge-fill.reformiste { background: linear-gradient(90deg, #1e3a5f, #3a6ea5); }
        .gauge-fill.radical { background: linear-gradient(90deg, #8b0000, #c41e3a); }
        .gauge-fill.opportuniste { background: linear-gradient(90deg, #8b6914, #c9a227); }
        .gauge-fill.danger { background: linear-gradient(90deg, #8b0000, #ff4444); }
        .score-value {
            font-family: 'Cinzel', serif;
            font-size: 0.75rem;
            color: var(--blanc-royal);
            opacity: 0.8;
        }
        .score-item.savoir {
            background: rgba(74,124,89,0.3);
            border-radius: 4px;
            border: 1px solid rgba(74,124,89,0.5);
        }
        .score-item.savoir .score-item-header { color: #90EE90; }
        .container {
            max-width: 850px;
            margin: 0 auto;
            padding: 2rem 2rem 100px;
            position: relative;
            z-index: 1;
        }
        .intro-screen {
            min-height: calc(100vh - 100px);
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 2rem;
        }
        .intro-content {
            text-align: center;
            background: var(--blanc-royal);
            padding: 3rem 4rem;
            border: 4px double var(--sepia);
            box-shadow: 0 0 0 8px var(--parchemin), 0 0 0 12px var(--sepia), 0 20px 60px rgba(0,0,0,0.3);
            position: relative;
            animation: fadeInUp 1s ease-out;
        }
        .intro-content::before {
            content: 'üèõÔ∏è';
            position: absolute;
            top: -40px;
            left: 50%;
            transform: translateX(-50%);
            font-size: 3rem;
        }
        .main-title {
            font-family: 'Cinzel', serif;
            font-size: 2.5rem;
            font-weight: 900;
            color: var(--bleu-roi);
            text-transform: uppercase;
            letter-spacing: 3px;
            margin-bottom: 0.5rem;
        }
        .subtitle {
            font-family: 'UnifrakturMaguntia', cursive;
            font-size: 1.8rem;
            color: var(--rouge-sang);
            margin-bottom: 2rem;
        }
        .tricolore-banner {
            display: flex;
            justify-content: center;
            margin: 2rem 0;
        }
        .tricolore-banner span {
            width: 40px;
            height: 80px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 2rem;
        }
        .tricolore-banner .bleu { background: var(--bleu-roi); }
        .tricolore-banner .blanc { background: var(--blanc-royal); border-top: 1px solid #ddd; border-bottom: 1px solid #ddd; }
        .tricolore-banner .rouge { background: var(--rouge-sang); }
        .intro-text {
            font-size: 1.15rem;
            color: var(--sepia);
            margin-bottom: 1.5rem;
            max-width: 500px;
            margin-left: auto;
            margin-right: auto;
        }
        .btn-primary {
            display: inline-block;
            background: linear-gradient(180deg, var(--rouge-sang) 0%, #7a1515 100%);
            color: var(--blanc-royal);
            border: none;
            padding: 1rem 2.5rem;
            font-family: 'Cinzel', serif;
            font-size: 1.1rem;
            font-weight: 700;
            text-transform: uppercase;
            letter-spacing: 2px;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(164, 28, 28, 0.4);
        }
        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 25px rgba(164, 28, 28, 0.5);
        }
        .btn-secondary {
            background: linear-gradient(180deg, var(--bleu-roi) 0%, #001a3d 100%);
        }
        .section-title {
            font-family: 'Cinzel', serif;
            font-size: 2rem;
            color: var(--bleu-roi);
            text-align: center;
            margin-bottom: 0.5rem;
            text-transform: uppercase;
            letter-spacing: 2px;
        }
        .section-subtitle {
            text-align: center;
            color: var(--sepia);
            font-style: italic;
            margin-bottom: 2rem;
        }
        .parchment-box {
            background: var(--blanc-royal);
            border: 3px solid var(--sepia);
            padding: 2rem;
            margin-bottom: 2rem;
            position: relative;
            box-shadow: 0 10px 40px rgba(0,0,0,0.15);
        }
        .warning-box {
            background: linear-gradient(135deg, #fff9e6 0%, #fff3cc 100%);
            border-left: 4px solid var(--or-ancien);
            padding: 1rem 1.5rem;
            margin-bottom: 2rem;
            font-style: italic;
            display: flex;
            align-items: flex-start;
            gap: 1rem;
        }
        .warning-box::before {
            content: '‚ö†Ô∏è';
            font-size: 1.5rem;
            flex-shrink: 0;
        }
        .character-form {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 1.2rem;
        }
        .form-group {
            display: flex;
            flex-direction: column;
        }
        .form-group label {
            font-family: 'Cinzel', serif;
            font-size: 0.9rem;
            font-weight: 700;
            color: var(--sepia);
            margin-bottom: 0.4rem;
            text-transform: uppercase;
            letter-spacing: 1px;
        }
        .form-group input, .form-group select {
            padding: 0.8rem;
            font-family: 'EB Garamond', Georgia, serif;
            font-size: 1.05rem;
            border: 2px solid rgba(112, 66, 20, 0.3);
            background: var(--parchemin);
            color: var(--encre);
            transition: all 0.3s ease;
        }
        .form-group input:focus, .form-group select:focus {
            outline: none;
            border-color: var(--or-ancien);
            box-shadow: 0 0 0 3px rgba(201, 162, 39, 0.2);
        }
        .progress-container {
            background: var(--blanc-royal);
            border: 2px solid var(--sepia);
            padding: 1rem;
            margin-bottom: 2rem;
            text-align: center;
        }
        .progress-label {
            font-family: 'Cinzel', serif;
            font-size: 0.9rem;
            color: var(--sepia);
            margin-bottom: 0.5rem;
            text-transform: uppercase;
            letter-spacing: 1px;
        }
        .progress-bar {
            height: 12px;
            background: rgba(112, 66, 20, 0.1);
            border: 1px solid var(--sepia);
            overflow: hidden;
        }
        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, var(--bleu-roi), var(--rouge-sang));
            transition: width 0.5s ease;
        }
        .situation-card {
            background: var(--blanc-royal);
            border: 3px solid var(--sepia);
            box-shadow: 0 15px 50px rgba(0,0,0,0.2);
            overflow: hidden;
        }
        .situation-header {
            background: linear-gradient(135deg, var(--bleu-roi) 0%, #001a3d 100%);
            color: var(--blanc-royal);
            padding: 1.5rem 2rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        .situation-year {
            font-family: 'Cinzel', serif;
            font-size: 2.5rem;
            font-weight: 900;
        }
        .situation-acte {
            font-family: 'Cinzel', serif;
            font-size: 0.85rem;
            text-transform: uppercase;
            letter-spacing: 2px;
            opacity: 0.8;
        }
        .situation-icon { font-size: 3rem; }
        .situation-body { padding: 2rem; }
        .situation-title {
            font-family: 'Cinzel', serif;
            font-size: 1.6rem;
            color: var(--bleu-roi);
            margin-bottom: 1.5rem;
            padding-bottom: 1rem;
            border-bottom: 2px solid rgba(112, 66, 20, 0.2);
            text-transform: uppercase;
            letter-spacing: 1px;
        }
        .situation-text {
            font-size: 1.1rem;
            line-height: 1.9;
            color: var(--encre);
            margin-bottom: 2rem;
        }
        .situation-text em { color: var(--rouge-sang); font-style: italic; }
        .term {
            color: var(--rouge-sang);
            font-style: italic;
            cursor: help;
            position: relative;
            border-bottom: 1px dotted var(--rouge-sang);
        }
        .term:hover::after {
            content: attr(data-def);
            position: absolute;
            bottom: 100%;
            left: 50%;
            transform: translateX(-50%);
            background: var(--encre);
            color: var(--blanc-royal);
            padding: 0.8rem 1rem;
            border-radius: 4px;
            font-size: 0.9rem;
            font-style: normal;
            white-space: normal;
            width: 250px;
            max-width: 80vw;
            z-index: 100;
            box-shadow: 0 4px 15px rgba(0,0,0,0.3);
            line-height: 1.5;
        }
        .term:hover::before {
            content: '';
            position: absolute;
            bottom: 100%;
            left: 50%;
            transform: translateX(-50%) translateY(100%);
            border: 8px solid transparent;
            border-top-color: var(--encre);
            z-index: 101;
        }
        .situation-question {
            font-family: 'Cinzel', serif;
            font-size: 1.1rem;
            color: var(--sepia);
            margin-bottom: 1.5rem;
            font-weight: 700;
        }
        .choices-container {
            display: flex;
            flex-direction: column;
            gap: 0.8rem;
        }
        .choice-btn {
            background: var(--parchemin);
            border: 2px solid rgba(112, 66, 20, 0.3);
            padding: 1rem 1.5rem;
            font-family: 'EB Garamond', Georgia, serif;
            font-size: 1.05rem;
            text-align: left;
            cursor: pointer;
            transition: all 0.3s ease;
            position: relative;
        }
        .btn-savoir-plus {
            display: inline-block;
            margin-bottom: 1.5rem;
            background: transparent;
            border: 2px solid #4a7c59;
            color: #4a7c59;
            padding: 0.5rem 1rem;
            font-family: Cinzel, serif;
            font-size: 0.85rem;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        .btn-savoir-plus:hover {
            background: #4a7c59;
            color: white;
        }
        .choice-btn:hover {
            background: var(--blanc-royal);
            border-color: var(--or-ancien);
            padding-left: 2rem;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
        }
        .modal-overlay {
            position: fixed;
            top: 0; left: 0; right: 0; bottom: 0;
            background: rgba(0, 0, 0, 0.85);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 2000;
            padding: 1rem;
        }
        .modal-content {
            background: var(--blanc-royal);
            border: 4px solid var(--sepia);
            max-width: 650px;
            max-height: 85vh;
            overflow-y: auto;
            position: relative;
            animation: fadeInUp 0.4s ease;
        }
        .modal-header {
            background: linear-gradient(135deg, #4a7c59, #3d6b4a);
            color: var(--blanc-royal);
            padding: 1.5rem 2rem;
            padding-right: 4rem;
        }
        .modal-header h3 {
            font-family: 'Cinzel', serif;
            font-size: 1.3rem;
            text-transform: uppercase;
            letter-spacing: 1px;
        }
        .modal-close {
            position: absolute;
            top: 1rem;
            right: 1rem;
            background: var(--rouge-sang);
            border: none;
            color: white;
            width: 40px;
            height: 40px;
            font-size: 1.5rem;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        .modal-close:hover { background: #c41e3a; transform: scale(1.1); }
        .modal-body { padding: 2rem; line-height: 1.8; }
        .quiz-question {
            font-family: 'Cinzel', serif;
            font-size: 1.2rem;
            color: var(--bleu-roi);
            margin-bottom: 2rem;
            line-height: 1.6;
        }
        .quiz-options {
            display: flex;
            flex-direction: column;
            gap: 0.8rem;
            margin-bottom: 1.5rem;
        }
        .quiz-option {
            background: var(--parchemin);
            border: 2px solid rgba(112, 66, 20, 0.3);
            padding: 1rem 1.5rem;
            font-family: 'EB Garamond', Georgia, serif;
            font-size: 1.05rem;
            cursor: pointer;
            transition: all 0.3s ease;
            text-align: left;
        }
        .quiz-option:hover:not(:disabled) {
            border-color: var(--or-ancien);
            background: var(--blanc-royal);
        }
        .quiz-option.correct { background: #d4edda; border-color: #4a7c59; }
        .quiz-option.incorrect { background: #f8d7da; border-color: var(--rouge-sang); }
        .quiz-option:disabled { cursor: default; }
        .quiz-score {
            font-family: 'Cinzel', serif;
            font-size: 1.3rem;
            text-align: center;
            padding: 1.5rem;
            margin: 2rem 0;
            background: var(--parchemin);
            border: 2px solid var(--sepia);
        }
        .quiz-feedback {
            padding: 1.5rem;
            margin: 1rem 0;
            text-align: center;
            font-size: 1.1rem;
        }
        .quiz-feedback.excellent { background: #d4edda; border-left: 4px solid #4a7c59; }
        .quiz-feedback.good { background: #fff3cd; border-left: 4px solid var(--or-ancien); }
        .quiz-feedback.retry { background: #f8d7da; border-left: 4px solid var(--rouge-sang); }
        .result-card {
            background: var(--blanc-royal);
            border: 4px double var(--sepia);
            padding: 2rem;
            margin-bottom: 2rem;
            text-align: center;
            box-shadow: 0 10px 40px rgba(0,0,0,0.15);
        }
        .result-title {
            font-family: 'Cinzel', serif;
            font-size: 1.8rem;
            color: var(--bleu-roi);
            margin-bottom: 1rem;
            text-transform: uppercase;
            letter-spacing: 2px;
        }
        .character-recap {
            font-size: 1.2rem;
            color: var(--sepia);
            margin-bottom: 1.5rem;
        }
        .scores-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 1rem;
            margin: 2rem 0;
        }
        .score-card {
            padding: 1.5rem;
            text-align: center;
            border: 2px solid;
        }
        .score-card.royaliste { background: #f9f9f9; border-color: #ccc; color: var(--encre); }
        .score-card.reformiste { background: var(--bleu-liberte); border-color: var(--bleu-roi); color: white; }
        .score-card.radical { background: var(--rouge-sang); border-color: #7a1515; color: white; }
        .score-card.opportuniste { background: var(--or-ancien); border-color: #a68521; color: var(--encre); }
        .score-card-emoji { font-size: 2.5rem; margin-bottom: 0.5rem; }
        .score-card-label {
            font-family: 'Cinzel', serif;
            font-size: 0.85rem;
            text-transform: uppercase;
            letter-spacing: 1px;
            margin-bottom: 0.5rem;
        }
        .score-card-value { font-family: 'Cinzel', serif; font-size: 2rem; font-weight: 900; }
        .profile-result {
            padding: 2rem;
            margin: 2rem 0;
            text-align: center;
        }
        .profile-result.royaliste { background: linear-gradient(135deg, #f5f5f5, #e8e8e8); border: 3px solid #ccc; }
        .profile-result.reformiste { background: linear-gradient(135deg, var(--bleu-liberte), var(--bleu-roi)); color: white; }
        .profile-result.radical { background: linear-gradient(135deg, var(--rouge-sang), #7a1515); color: white; }
        .profile-result.opportuniste { background: linear-gradient(135deg, var(--or-ancien), #a68521); }
        .profile-emoji { font-size: 4rem; margin-bottom: 1rem; }
        .profile-name {
            font-family: 'Cinzel', serif;
            font-size: 1.8rem;
            text-transform: uppercase;
            letter-spacing: 2px;
            margin-bottom: 1rem;
        }
        .profile-description {
            font-size: 1.1rem;
            line-height: 1.8;
            text-align: justify;
            max-width: 600px;
            margin: 0 auto;
        }
        .knowledge-result {
            background: #f0f4e8;
            border: 2px solid #4a7c59;
            padding: 1.5rem;
            text-align: center;
            margin: 2rem 0;
        }
        .knowledge-result span { font-family: 'Cinzel', serif; font-size: 1.3rem; }
        .heritage-box {
            background: var(--parchemin);
            border: 3px solid var(--sepia);
            padding: 2rem;
            margin: 2rem 0;
        }
        .heritage-title {
            font-family: 'Cinzel', serif;
            font-size: 1.3rem;
            color: var(--bleu-roi);
            text-align: center;
            margin-bottom: 1.5rem;
            text-transform: uppercase;
        }
        .heritage-list { list-style: none; }
        .heritage-list li {
            padding: 0.8rem 0;
            border-bottom: 1px solid rgba(112, 66, 20, 0.2);
            display: flex;
            align-items: center;
            gap: 1rem;
        }
        .heritage-list li:last-child { border-bottom: none; }
        .heritage-list li span:first-child { font-size: 1.5rem; }
        @media (max-width: 768px) {
            body::before { border-width: 6px; }
            .container { padding: 1.5rem 1rem 90px; }
            .score-bar { 
                flex-wrap: wrap; 
                justify-content: center; 
                padding: 0.4rem 0.5rem; 
                gap: 0.3rem;
            }
            .score-item { 
                min-width: 50px; 
                padding: 0.15rem 0.25rem;
            }
            .score-item-header { font-size: 0.55rem; }
            .score-item-header .emoji { font-size: 0.8rem; }
            .gauge-container { height: 5px; }
            .score-value { font-size: 0.6rem; }
            .main-title { font-size: 1.8rem; }
            .subtitle { font-size: 1.4rem; }
            .intro-content { padding: 2rem 1.5rem; }
            .situation-header { padding: 1rem; }
            .situation-year { font-size: 1.8rem; }
            .situation-icon { font-size: 2rem; }
            .situation-body { padding: 1.5rem; }
            .situation-title { font-size: 1.3rem; }
            .scores-grid { gap: 0.5rem; }
            .score-card { padding: 1rem; }
            .score-card-emoji { font-size: 1.8rem; }
            .score-card-value { font-size: 1.5rem; }
            .term:hover::after {
                width: 200px;
                font-size: 0.8rem;
                padding: 0.6rem 0.8rem;
            }
        }
    </style>
</head>
<body>
    <div class="score-bar hidden" id="scoreBar">
        <div class="score-item" title="Royaliste conservateur">
            <div class="score-item-header"><span class="emoji">üëë</span> Royal.</div>
            <div class="gauge-container"><div class="gauge-fill royaliste" id="gaugeRoyaliste"></div></div>
            <div class="score-value"><span id="scoreRoyaliste">0</span></div>
        </div>
        <div class="score-item" title="R√©formiste mod√©r√©">
            <div class="score-item-header"><span class="emoji">‚öñÔ∏è</span> R√©form.</div>
            <div class="gauge-container"><div class="gauge-fill reformiste" id="gaugeReformiste"></div></div>
            <div class="score-value"><span id="scoreReformiste">0</span></div>
        </div>
        <div class="score-item" title="R√©volutionnaire radical">
            <div class="score-item-header"><span class="emoji">‚úä</span> Radical</div>
            <div class="gauge-container"><div class="gauge-fill radical" id="gaugeRadical"></div></div>
            <div class="score-value"><span id="scoreRadical">0</span></div>
        </div>
        <div class="score-item" title="Opportuniste pragmatique">
            <div class="score-item-header"><span class="emoji">üé≠</span> Opport.</div>
            <div class="gauge-container"><div class="gauge-fill opportuniste" id="gaugeOpportuniste"></div></div>
            <div class="score-value"><span id="scoreOpportuniste">0</span></div>
        </div>
        <div class="score-item" title="Niveau de danger">
            <div class="score-item-header"><span class="emoji">‚ö†Ô∏è</span> Danger</div>
            <div class="gauge-container"><div class="gauge-fill danger" id="gaugeDanger"></div></div>
            <div class="score-value"><span id="scoreDanger">0</span></div>
        </div>
        <div class="score-item savoir" title="Connaissances">
            <div class="score-item-header"><span class="emoji">üìö</span> Savoir</div>
            <div class="score-value"><span id="scoreSavoir">0</span>/24</div>
        </div>
    </div>

    <div class="container">
        <div class="intro-screen" id="introScreen">
            <div class="intro-content">
                <h1 class="main-title">J'ai v√©cu la R√©volution</h1>
                <p class="subtitle">La Terreur et l'Empire</p>
                <div class="tricolore-banner">
                    <span class="bleu"></span>
                    <span class="blanc">‚öúÔ∏è</span>
                    <span class="rouge"></span>
                </div>
                <p class="intro-text">1789-1821. Tu vas traverser 32 ans d'histoire tumultueuse : la chute de la monarchie, la Terreur, l'ascension de Napol√©on, la gloire et la d√©faite de l'Empire.</p>
                <p class="intro-text">Tes choix r√©v√®leront ton profil politique. Quel citoyen aurais-tu √©t√© ?</p>
                <button class="btn-primary" id="startBtn">Cr√©er mon personnage</button>
            </div>
        </div>

        <div class="character-screen hidden" id="characterScreen">
            <h2 class="section-title">Cr√©ation de ton personnage</h2>
            <p class="section-subtitle">Qui es-tu en cette ann√©e 1789 ?</p>
            <div class="warning-box"><span>Ton personnage doit √™tre coh√©rent ! Un avocat n'habite pas √† la campagne, un paysan n'est pas tr√®s riche...</span></div>
            <div class="parchment-box">
                <div class="character-form">
                    <div class="form-group"><label>Nom</label><input type="text" id="charNom" placeholder="Dupont"></div>
                    <div class="form-group"><label>Pr√©nom</label><input type="text" id="charPrenom" placeholder="Jean"></div>
                    <div class="form-group"><label>√Çge en 1789</label><input type="text" id="charAge" placeholder="34 ans"></div>
                    <div class="form-group"><label>Ordre</label><select id="charOrdre"><option value="">Choisir...</option><option value="Clerg√©">Clerg√©</option><option value="Noblesse">Noblesse</option><option value="Tiers-√âtat">Tiers-√âtat</option></select></div>
                    <div class="form-group"><label>M√©tier</label><input type="text" id="charMetier" placeholder="Avocat, paysan..."></div>
                    <div class="form-group"><label>Lieu de r√©sidence</label><input type="text" id="charLieu" placeholder="Paris, Lyon..."></div>
                    <div class="form-group"><label>Situation familiale</label><input type="text" id="charFamille" placeholder="Mari√©, 3 enfants"></div>
                    <div class="form-group"><label>Niveau de richesse</label><select id="charRichesse"><option value="">Choisir...</option><option value="Tr√®s pauvre">Tr√®s pauvre</option><option value="Modeste">Modeste</option><option value="Ais√©">Ais√©</option><option value="Riche">Riche</option></select></div>
                </div>
            </div>
            <div style="text-align: center;"><button class="btn-primary" id="beginBtn">Commencer l'aventure</button></div>
        </div>

        <div class="game-screen hidden" id="gameScreen">
            <div class="progress-container">
                <div class="progress-label">Progression dans l'histoire</div>
                <div class="progress-bar"><div class="progress-fill" id="progressFill" style="width: 0%"></div></div>
                <div style="margin-top: 0.5rem; font-size: 0.9rem;" id="progressText">Situation 1 / 29</div>
            </div>
            <div class="situation-card" id="situationCard"></div>
        </div>

        <div class="quiz-screen hidden" id="quizScreen">
            <div class="parchment-box">
                <h2 class="section-title" id="quizTitle">Quiz de fin d'acte</h2>
                <p class="section-subtitle" id="quizSubtitle">V√©rifie tes connaissances</p>
                <div id="quizContent"></div>
            </div>
        </div>

        <div class="end-screen hidden" id="endScreen"></div>
    </div>

    <div class="modal-overlay hidden" id="encartModal">
        <div class="modal-content">
            <button class="modal-close" id="closeEncart">√ó</button>
            <div class="modal-header"><h3>üìú Le savais-tu ?</h3></div>
            <div class="modal-body" id="encartBody"></div>
            <div style="padding: 0 2rem 2rem; text-align: center;"><button class="btn-primary btn-secondary" id="continueBtn">Continuer</button></div>
        </div>
    </div>

<div class="modal-overlay hidden" id="savoirPlusModal">
        <div class="modal-content">
            <button class="modal-close" id="closeSavoirPlus">√ó</button>
            <div class="modal-header" style="background: linear-gradient(135deg, var(--bleu-roi), #001a3d);"><h3 id="savoirPlusTitle">En savoir plus</h3></div>
            <div class="modal-body" id="savoirPlusBody"></div>
            <div style="padding: 0 2rem 2rem; text-align: center;"><button class="btn-primary btn-secondary" id="closeSavoirPlusBtn">Fermer</button></div>
        </div>
    </div>

<script>
// Dictionnaire des termes historiques avec d√©finitions
const definitions = {
    "√âtats g√©n√©raux": "Assembl√©e r√©unissant les repr√©sentants des trois ordres (Clerg√©, Noblesse, Tiers-√âtat) pour conseiller le roi. Pas r√©unie depuis 1614 !",
    "cahier de dol√©ances": "Document o√π chaque communaut√© √©crivait ses plaintes et ses souhaits de r√©formes pour les pr√©senter au roi.",
    "cahiers de dol√©ances": "Documents o√π chaque communaut√© √©crivait ses plaintes et ses souhaits de r√©formes pour les pr√©senter au roi.",
    "Assembl√©e nationale": "Nom que se sont donn√© les d√©put√©s du Tiers-√âtat le 17 juin 1789, affirmant repr√©senter la Nation enti√®re.",
    "Constitution": "Texte fondamental qui d√©finit les r√®gles du pouvoir : qui gouverne, comment, et quels sont les droits des citoyens.",
    "Bastille": "Forteresse m√©di√©vale √† Paris servant de prison d'√âtat. Symbole de l'arbitraire royal car le roi pouvait y enfermer n'importe qui sans proc√®s.",
    "cocardes tricolores": "Insigne rond aux couleurs bleu-blanc-rouge, symbole du ralliement √† la R√©volution. Le bleu et rouge sont les couleurs de Paris, le blanc celle du roi.",
    "cocarde tricolore": "Insigne rond aux couleurs bleu-blanc-rouge, symbole du ralliement √† la R√©volution.",
    "Grande Peur": "Panique collective dans les campagnes √† l'√©t√© 1789. Des rumeurs de \"brigands\" poussent les paysans √† s'armer et √† attaquer les ch√¢teaux.",
    "abolition des privil√®ges": "Suppression des avantages accord√©s √† la noblesse et au clerg√© (exemptions d'imp√¥ts, droits seigneuriaux, d√Æme...).",
    "D√©claration des Droits de l'Homme et du Citoyen": "Texte fondateur vot√© le 26 ao√ªt 1789, proclamant les droits naturels de l'homme : libert√©, √©galit√©, propri√©t√©, s√ªret√©.",
    "D√©claration des Droits de l'Homme": "Texte fondateur vot√© le 26 ao√ªt 1789, proclamant les droits naturels : libert√©, √©galit√©, propri√©t√©.",
    "DDHC": "D√©claration des Droits de l'Homme et du Citoyen (26 ao√ªt 1789).",
    "biens nationaux": "Propri√©t√©s confisqu√©es √† l'√âglise et aux √©migr√©s, vendues par l'√âtat pour rembourser la dette.",
    "Constitution civile du clerg√©": "Loi de 1790 r√©organisant l'√âglise : les pr√™tres deviennent fonctionnaires et doivent pr√™ter serment √† la Nation.",
    "jureurs": "Pr√™tres ayant pr√™t√© le serment de fid√©lit√© √† la Constitution civile du clerg√©.",
    "r√©fractaires": "Pr√™tres ayant refus√© de pr√™ter serment √† la Constitution civile du clerg√©, fid√®les au pape.",
    "F√™te de la F√©d√©ration": "Grande f√™te nationale du 14 juillet 1790, c√©l√©brant l'unit√© de la France r√©volutionnaire.",
    "f√©d√©r√©s": "Gardes nationaux venus de toute la France pour la F√™te de la F√©d√©ration.",
    "Varennes": "Ville o√π Louis XVI a √©t√© arr√™t√© lors de sa tentative de fuite le 21 juin 1791.",
    "Girondins": "Groupe de d√©put√©s r√©publicains mod√©r√©s, souvent originaires de la Gironde. Favorables √† la guerre.",
    "Montagnards": "D√©put√©s radicaux si√©geant en haut de l'assembl√©e. Alli√©s des sans-culottes parisiens.",
    "sans-culottes": "R√©volutionnaires parisiens issus du peuple. Ils portent le pantalon (pas la culotte des aristocrates) et le bonnet phrygien.",
    "Terreur": "P√©riode (1793-1794) o√π le gouvernement r√©volutionnaire utilise la violence pour √©liminer ses ennemis. Environ 17 000 ex√©cutions officielles.",
    "Tribunal r√©volutionnaire": "Tribunal d'exception cr√©√© en 1793 pour juger rapidement les \"ennemis de la R√©volution\". Pas d'appel possible.",
    "loi des suspects": "Loi du 17 septembre 1793 permettant d'arr√™ter toute personne suspect√©e d'√™tre \"ennemie de la libert√©\".",
    "guillotine": "Machine √† d√©capiter adopt√©e en 1792 comme moyen d'ex√©cution \"humain\" car rapide et √©galitaire.",
    "Thermidor": "Mois du calendrier r√©volutionnaire (juillet-ao√ªt). Le 9 Thermidor an II (27 juillet 1794), Robespierre est renvers√©.",
    "r√©action thermidorienne": "P√©riode apr√®s la chute de Robespierre o√π les anciens terroristes sont poursuivis et la Terreur d√©mantel√©e.",
    "Directoire": "R√©gime politique (1795-1799) dirig√© par cinq \"directeurs\". Instable et corrompu.",
    "coup d'√âtat": "Prise du pouvoir par la force, en dehors des r√®gles l√©gales.",
    "18 Brumaire": "Coup d'√âtat de Napol√©on Bonaparte le 9 novembre 1799, mettant fin au Directoire.",
    "Consulat": "R√©gime politique (1799-1804) o√π Bonaparte gouverne comme Premier Consul, puis Consul √† vie.",
    "Concordat": "Accord sign√© en 1801 entre Bonaparte et le pape, r√©tablissant la paix religieuse en France.",
    "Code civil": "Recueil de lois promulgu√© en 1804, unifiant le droit fran√ßais. Encore en vigueur aujourd'hui !",
    "sacre": "C√©r√©monie religieuse o√π un souverain est couronn√©. Napol√©on s'est couronn√© lui-m√™me en 1804.",
    "blocus continental": "Politique de Napol√©on interdisant le commerce avec l'Angleterre. A ruin√© les ports fran√ßais.",
    "Cent-Jours": "P√©riode de mars √† juin 1815 o√π Napol√©on reprend le pouvoir apr√®s son √©vasion de l'√Æle d'Elbe.",
    "Waterloo": "Bataille du 18 juin 1815 en Belgique o√π Napol√©on est d√©finitivement vaincu.",
    "Sainte-H√©l√®ne": "√éle britannique dans l'Atlantique Sud o√π Napol√©on a √©t√© exil√© de 1815 jusqu'√† sa mort en 1821."
};

// Fonction pour remplacer les termes par des spans avec tooltip
function addTooltips(text) {
    let result = text;
    // Remplacer les <em>terme</em> par des spans avec d√©finition
    result = result.replace(/<em>([^<]+)<\/em>/g, function(match, terme) {
        const def = definitions[terme];
        if (def) {
            return '<span class="term" data-def="' + def.replace(/"/g, '&quot;') + '">' + terme + '</span>';
        }
        return '<span class="term">' + terme + '</span>';
    });
    return result;
}

const actes = [
    { id: 1, nom: "La fin de l'Ancien R√©gime", periode: "1788-1789" },
    { id: 2, nom: "La monarchie constitutionnelle", periode: "1789-1792" },
    { id: 3, nom: "La R√©publique et la Terreur", periode: "1792-1794" },
    { id: 4, nom: "La R√©publique bourgeoise", periode: "1794-1799" },
    { id: 5, nom: "Le Consulat et l'Empire", periode: "1799-1815" },
    { id: 6, nom: "√âpilogue", periode: "1814-1821" }
];

const situations = [
    // ACTE I
    { id: 1, acte: 1, year: 1789, title: "Les cahiers de dol√©ances", icon: "üìú",
      text: "L'hiver 1788 a √©t√© terrible : gel, r√©coltes d√©truites, prix du pain qui double. La France est au bord de la faillite. Face √† la crise, Louis XVI convoque les <em>√âtats g√©n√©raux</em> ‚Äî une assembl√©e des trois ordres qui ne s'est pas r√©unie depuis 175 ans !\n\nChaque ordre doit r√©diger un <em>cahier de dol√©ances</em> pour exprimer ses plaintes. Dans ton village, l'assembl√©e se r√©unit √† l'√©glise. L'atmosph√®re est tendue, chacun veut s'exprimer...",
      question: "C'est ton tour de parler. Que dis-tu ?",
      encart: "<strong>Plus de 60 000 cahiers de dol√©ances</strong> ont √©t√© r√©dig√©s au printemps 1789 ! Paysans, artisans, bourgeois, cur√©s... tous ont pu s'exprimer. Ces cahiers r√©clamaient presque unanimement : la fin des privil√®ges fiscaux, une meilleure repr√©sentation du Tiers-√âtat, et des r√©formes de la justice.",
      savoirPlus: "<h4>Les √âtats g√©n√©raux, c'est quoi ?</h4><p>C'est une assembl√©e exceptionnelle o√π les trois ordres (Clerg√©, Noblesse, Tiers-√âtat) se r√©unissent pour conseiller le roi. La derni√®re convocation datait de 1614 !</p><h4>Pourquoi cette crise ?</h4><p>La France est ruin√©e par : les guerres co√ªteuses (aide aux Am√©ricains), les d√©penses de Versailles, un syst√®me fiscal injuste o√π nobles et clerg√© ne paient presque pas d'imp√¥ts.</p><h4>Le Tiers-√âtat, c'est qui ?</h4><p>98% de la population ! Tous ceux qui ne sont ni nobles ni clercs : paysans, artisans, bourgeois, avocats...</p>",
      choices: [
        { text: "\"Le roi est bon, mais ses ministres l'ont mal conseill√©. Demandons de baisser les imp√¥ts.\"", effects: { royaliste: 2 } },
        { text: "\"Abolissons les privil√®ges ! Pourquoi nobles et clerg√© ne paient-ils pas d'imp√¥ts comme nous ?\"", effects: { reformiste: 2 } },
        { text: "\"Les cahiers ne servent √† rien ! Le peuple cr√®ve pendant que les nobles festoient !\"", effects: { radical: 2, danger: 1 } },
        { text: "\"Je propose qu'on me choisisse comme d√©l√©gu√© pour Versailles...\"", effects: { opportuniste: 2, notoriete: 1 } }
      ]
    },
    { id: 2, acte: 1, year: 1789, title: "Le Serment du Jeu de Paume", icon: "‚úä",
      text: "Les √âtats g√©n√©raux s'ouvrent √† Versailles le 5 mai 1789. Mais un conflit √©clate : comment voter ? <em>\"Par ordre\"</em> (Clerg√© + Noblesse = 2 contre 1) ou <em>\"par t√™te\"</em> (chaque d√©put√© = une voix) ?\n\nLe roi refuse le vote par t√™te. Alors le 17 juin, le Tiers-√âtat se proclame <em>Assembl√©e nationale</em>. Le 20 juin, trouvant leur salle ferm√©e, les d√©put√©s jurent de ne jamais se s√©parer jusqu'√† ce qu'une Constitution soit √©tablie !",
      question: "Comment r√©agis-tu √† cette nouvelle extraordinaire ?",
      encart: "<strong>Le Jeu de Paume √©tait l'anc√™tre du tennis !</strong> C'est dans cette salle de sport que 577 d√©put√©s ont pr√™t√© leur serment historique. Un seul a refus√© : Martin d'Auch. Ce serment marque un tournant : le pouvoir vient d√©sormais de la Nation.",
      savoirPlus: "<h4>Pourquoi le vote par ordre √©tait-il injuste ?</h4><p>Clerg√© (1 voix) + Noblesse (1 voix) = 2 voix contre 1 pour le Tiers-√âtat, qui repr√©sentait pourtant 98% de la population !</p><h4>Qu'est-ce qu'une Constitution ?</h4><p>Un texte fondamental qui d√©finit les r√®gles du pouvoir : qui gouverne, comment sont prises les d√©cisions, quels sont les droits des citoyens. Avant 1789, le roi avait tous les pouvoirs.</p>",
      choices: [
        { text: "\"Ces d√©put√©s sont des rebelles ! Ils insultent le roi !\"", effects: { royaliste: 2 } },
        { text: "\"Quel courage ! Enfin des hommes qui osent d√©fier l'arbitraire !\"", effects: { reformiste: 2, notoriete: 1 } },
        { text: "\"Ce n'est qu'un d√©but ! Il faut abolir la monarchie et cr√©er une R√©publique !\"", effects: { radical: 2, danger: 1 } },
        { text: "\"Attendons de voir comment le roi r√©agit avant de se prononcer...\"", effects: { opportuniste: 2 } }
      ]
    },
    { id: 3, acte: 1, year: 1789, title: "La prise de la Bastille", icon: "üè∞",
      text: "Paris, 14 juillet 1789. Le roi a mass√© des troupes autour de la capitale et renvoy√© le ministre populaire Necker. La rumeur court : l'arm√©e va √©craser l'Assembl√©e !\n\nLa foule s'arme et marche sur la <em>Bastille</em> ‚Äî une forteresse-prison symbole de l'arbitraire royal. Apr√®s 4 heures de combat, la Bastille tombe. Le gouverneur de Launay est massacr√©, sa t√™te promen√©e au bout d'une pique.\n\nQuelques jours plus tard, on distribue des <em>cocardes tricolores</em>.",
      question: "Comment r√©agis-tu √† ces √©v√©nements ?",
      encart: "<strong>La Bastille ne contenait que 7 prisonniers</strong> ce jour-l√† (dont 4 faussaires et 2 fous) ! Mais elle symbolisait le pouvoir absolu : le roi pouvait y enfermer n'importe qui par \"lettre de cachet\". Le roi demande : <em>\"C'est une r√©volte ?\"</em> ‚Äî <em>\"Non Sire, c'est une r√©volution.\"</em>",
      savoirPlus: "<h4>Qu'est-ce qu'une lettre de cachet ?</h4><p>Un ordre d'emprisonnement sign√© par le roi, sans proc√®s. On pouvait √™tre enferm√© des ann√©es sans conna√Ætre les charges. Voltaire y a s√©journ√© deux fois !</p><h4>Les vainqueurs de la Bastille</h4><p>Environ 800 personnes ont particip√© √† l'assaut : artisans, ouvriers, soldats mutin√©s. 98 assaillants sont morts. Le roi a d√ª accepter de porter la cocarde tricolore.</p>",
      choices: [
        { text: "\"Une t√™te au bout d'une pique ! Ces gens sont des sauvages ! Le roi aurait d√ª faire tirer !\"", effects: { royaliste: 2 } },
        { text: "\"La Bastille est tomb√©e ! La libert√© est en marche !\" Tu √©pingles la cocarde.", effects: { reformiste: 2, notoriete: 1 } },
        { text: "\"Tr√®s bien ! Maintenant, faisons pareil avec tous les ch√¢teaux de France !\"", effects: { radical: 2, danger: 1 } },
        { text: "\"Mettons cette cocarde pour √©viter les ennuis... On ne sait jamais.\"", effects: { opportuniste: 2 } }
      ]
    },
    { id: 4, acte: 1, year: 1789, title: "La nuit du 4 ao√ªt", icon: "üî•",
      text: "Apr√®s la Bastille, une panique secoue les campagnes. Les paysans attaquent les ch√¢teaux. L'Assembl√©e vote l'<em>abolition des privil√®ges</em>.",
      question: "Comment r√©agis-tu ?",
      encart: "<strong>La nuit du 4 ao√ªt met fin √† la soci√©t√© d'ordres</strong> qui existait depuis le Moyen √Çge.",
      choices: [
        { text: "\"Ces paysans sont des voleurs ! Le seigneur avait des droits !\"", effects: { royaliste: 2, danger: 1 } },
        { text: "\"L'Assembl√©e a eu raison d'abolir les privil√®ges par la loi.\"", effects: { reformiste: 2 } },
        { text: "\"Maintenant, partageons les terres des nobles !\"", effects: { radical: 2 } },
        { text: "\"Tu te renseignes pour acheter les terres du seigneur qui a fui...\"", effects: { opportuniste: 2 } }
      ]
    },
    { id: 5, acte: 1, year: 1789, title: "La D√©claration des Droits de l'Homme", icon: "üìã",
      text: "L'Assembl√©e adopte la <em>D√©claration des Droits de l'Homme et du Citoyen</em> : \"Les hommes naissent et demeurent libres et √©gaux en droits.\"",
      question: "Qu'en penses-tu ?",
      encart: "<strong>La DDHC inspire encore le monde entier</strong> mais elle avait des limites : femmes exclues, suffrage censitaire, esclavage maintenu.",
      choices: [
        { text: "\"Impie ! Les hommes ne sont pas √©gaux : Dieu a voulu des nobles et des paysans !\"", effects: { royaliste: 2 } },
        { text: "\"Magnifique ! Libert√©, √©galit√©, propri√©t√©... les fondements d'une soci√©t√© juste !\"", effects: { reformiste: 2 } },
        { text: "\"√áa ne va pas assez loin ! Et les femmes ? Et les esclaves ?\"", effects: { radical: 2 } },
        { text: "\"C'est joli, mais est-ce que √ßa fera baisser le prix du pain ?\"", effects: { opportuniste: 2 } }
      ]
    },
    // ACTE II
    { id: 6, acte: 2, year: 1789, title: "Les journ√©es d'octobre", icon: "üë©",
      text: "Octobre 1789. Des milliers de femmes marchent sur Versailles : \"Du pain !\" La famille royale est ramen√©e √† Paris.",
      question: "Que penses-tu de ces √©v√©nements ?",
      encart: "<strong>Ce sont les femmes qui ont ramen√© le roi √† Paris !</strong> D√©sormais, Louis XVI est comme prisonnier.",
      choices: [
        { text: "\"Le roi prisonnier de la populace ! Quel scandale !\"", effects: { royaliste: 2 } },
        { text: "\"C'est normal : le roi doit vivre parmi son peuple.\"", effects: { reformiste: 2 } },
        { text: "\"Il aurait fallu envahir le ch√¢teau plus t√¥t !\"", effects: { radical: 2, danger: 1 } },
        { text: "\"Ces femmes avaient faim, elles ont agi. C'est compr√©hensible.\"", effects: { opportuniste: 2 } }
      ]
    },
    { id: 7, acte: 2, year: 1790, title: "La Constitution civile du clerg√©", icon: "‚õ™",
      text: "L'Assembl√©e confisque les biens de l'√âglise. Les pr√™tres doivent pr√™ter serment. Le clerg√© se divise entre \"jureurs\" et \"r√©fractaires\".",
      question: "Comment r√©agis-tu ?",
      encart: "<strong>Cette division religieuse alimentera les guerres civiles</strong>, notamment en Vend√©e.",
      choices: [
        { text: "\"Ce pauvre cur√© ! Je l'aide √† se cacher.\"", effects: { royaliste: 2, danger: 1 } },
        { text: "\"La loi est la loi. Il aurait d√ª pr√™ter serment.\"", effects: { reformiste: 2 } },
        { text: "\"Bon d√©barras ! Les cur√©s sont des parasites !\"", effects: { radical: 2 } },
        { text: "\"Les biens nationaux sont √† vendre ? Int√©ressant...\"", effects: { opportuniste: 2 } }
      ]
    },
    { id: 8, acte: 2, year: 1790, title: "La F√™te de la F√©d√©ration", icon: "üéâ",
      text: "14 juillet 1790 : la France c√©l√®bre son unit√©. 300 000 personnes. Le roi pr√™te serment √† la Constitution. On chante, on danse.",
      question: "On te propose d'y participer.",
      encart: "<strong>C'est le moment le plus optimiste de la R√©volution.</strong> Mais cette unit√© est fragile...",
      choices: [
        { text: "\"Je refuse ! Voir le roi humili√© ? Jamais !\"", effects: { royaliste: 2 } },
        { text: "\"J'y vais avec enthousiasme ! C'est un grand jour !\"", effects: { reformiste: 2 } },
        { text: "\"J'y vais, mais cette r√©conciliation est hypocrite.\"", effects: { radical: 1 } },
        { text: "\"J'y vais si je peux d√©filer en t√™te...\"", effects: { opportuniste: 2 } }
      ]
    },
    { id: 9, acte: 2, year: 1791, title: "La fuite √† Varennes", icon: "üèÉ",
      text: "Nuit du 20 juin 1791. Louis XVI et sa famille s'enfuient, d√©guis√©s. √Ä Varennes, le roi est reconnu et ramen√© √† Paris.",
      question: "C'est une trahison pour beaucoup. Comment r√©agis-tu ?",
      encart: "<strong>Le roi a √©t√© reconnu gr√¢ce √† son profil sur les pi√®ces de monnaie !</strong>",
      choices: [
        { text: "\"Pauvre roi ! Il avait raison de fuir !\"", effects: { royaliste: 2, danger: 1 } },
        { text: "\"C'est une erreur tragique. Donnons-lui une seconde chance.\"", effects: { reformiste: 2 } },
        { text: "\"Le roi est un tra√Ætre ! Il voulait livrer la France √† l'ennemi !\"", effects: { radical: 2, danger: 1 } },
        { text: "\"Attendons de voir... Peut-√™tre qu'il a √©t√© enlev√© ?\"", effects: { opportuniste: 2 } }
      ]
    },
    { id: 10, acte: 2, year: 1792, title: "La d√©claration de guerre", icon: "‚öîÔ∏è",
      text: "Printemps 1792. Les Girondins r√©clament la guerre. Robespierre s'y oppose. Le 20 avril, la France d√©clare la guerre. C'est le d√©but de 23 ans de guerres.",
      question: "Qu'en penses-tu ?",
      encart: "<strong>Cette guerre va durer 23 ans et faire des millions de morts !</strong>",
      choices: [
        { text: "\"Enfin ! Les arm√©es √©trang√®res vont r√©tablir le roi !\"", effects: { royaliste: 2 } },
        { text: "\"Cette guerre est juste : nous d√©fendons la libert√© !\"", effects: { reformiste: 2 } },
        { text: "\"Robespierre a raison : cette guerre est une folie !\"", effects: { radical: 2 } },
        { text: "\"Pourvu que la guerre ne vienne pas jusqu'ici...\"", effects: { opportuniste: 2 } }
      ]
    },
    // ACTE III
    { id: 11, acte: 3, year: 1792, title: "La chute de la royaut√©", icon: "üèõÔ∏è",
      text: "10 ao√ªt 1792. 20 000 sans-culottes attaquent les Tuileries. Les gardes suisses sont massacr√©s. Le roi est prisonnier. La monarchie s'effondre.",
      question: "Comment r√©agis-tu ?",
      encart: "<strong>600 gardes suisses sont morts ce jour-l√†.</strong> C'est aussi ce jour qu'on entend La Marseillaise √† Paris !",
      choices: [
        { text: "\"C'est la fin de tout ! Sans roi, la France est perdue !\"", effects: { royaliste: 2 } },
        { text: "\"C'√©tait in√©vitable apr√®s Varennes. Place √† la R√©publique !\"", effects: { reformiste: 2 } },
        { text: "\"Victoire ! Mort aux tyrans !\"", effects: { radical: 2, notoriete: 1, danger: 1 } },
        { text: "\"Attendons de voir qui prend le pouvoir...\"", effects: { opportuniste: 2 } }
      ]
    },
    { id: 12, acte: 3, year: 1792, title: "Les massacres de septembre", icon: "üíÄ",
      text: "Septembre 1792. Une rumeur : les prisonniers vont s'√©vader et massacrer les patriotes ! Des bandes envahissent les prisons. 1 400 morts en 5 jours.",
      question: "Comment r√©agis-tu ?",
      encart: "<strong>Parmi les morts, il y avait aussi des voleurs, des prostitu√©es, et m√™me des enfants.</strong>",
      choices: [
        { text: "\"Quelle horreur ! La R√©volution est devenue folle !\"", effects: { royaliste: 1, reformiste: 1 } },
        { text: "\"C'est terrible, mais compr√©hensible : la peur a rendu le peuple fou.\"", effects: { reformiste: 2 } },
        { text: "\"Ces aristocrates complotaient ! Le peuple a fait justice !\"", effects: { radical: 2, danger: 1 } },
        { text: "\"Je reste enferm√© chez moi.\"", effects: { opportuniste: 2 } }
      ]
    },
    { id: 13, acte: 3, year: 1793, title: "L'ex√©cution du roi", icon: "‚ö∞Ô∏è",
      text: "21 janvier 1793. Louis XVI est guillotin√©. \"Je meurs innocent.\" Le vote √©tait serr√© : 361 contre 360.",
      question: "Comment r√©agis-tu ?",
      encart: "<strong>Une seule voix de diff√©rence !</strong> L'ex√©cution choque toute l'Europe qui se coalise contre la France.",
      choices: [
        { text: "\"C'est un crime abominable ! Ils ont tu√© l'oint de Dieu !\"", effects: { royaliste: 2, danger: 2 } },
        { text: "\"C'est terrible mais n√©cessaire. On ne pouvait pas garder un roi tra√Ætre.\"", effects: { reformiste: 2 } },
        { text: "\"Enfin ! Mort au tyran !\"", effects: { radical: 2 } },
        { text: "\"Je n'ai pas d'opinion. J'attends de voir la suite.\"", effects: { opportuniste: 2 } }
      ]
    },
    { id: 14, acte: 3, year: 1793, title: "La Vend√©e", icon: "üéñÔ∏è",
      text: "Mars 1793. La lev√©e de 300 000 hommes d√©clenche une r√©volte en Vend√©e. Les paysans d√©fendent leurs pr√™tres. Guerre civile.",
      question: "Comment juges-tu cette r√©volte ?",
      encart: "<strong>Entre 150 000 et 300 000 morts.</strong> Certains parlent de g√©nocide.",
      choices: [
        { text: "\"Ces Vend√©ens sont des h√©ros ! Ils d√©fendent la foi !\"", effects: { royaliste: 2, danger: 2 } },
        { text: "\"Je comprends, mais la patrie est en danger.\"", effects: { reformiste: 2 } },
        { text: "\"Ce sont des tra√Ætres ! Il faut les √©craser !\"", effects: { radical: 2, danger: 1 } },
        { text: "\"Ouf, je n'ai pas √©t√© tir√© au sort...\"", effects: { opportuniste: 2 } }
      ]
    },
    { id: 15, acte: 3, year: 1793, title: "L'assassinat de Marat", icon: "üó°Ô∏è",
      text: "13 juillet 1793. Charlotte Corday poignarde Marat dans sa baignoire. Elle esp√©rait arr√™ter la Terreur. C'est l'inverse.",
      question: "Comment r√©agis-tu ?",
      encart: "<strong>Charlotte Corday : \"J'ai tu√© un homme pour en sauver cent mille.\"</strong> Son geste a acc√©l√©r√© la Terreur.",
      choices: [
        { text: "\"Cette femme est une h√©ro√Øne !\"", effects: { royaliste: 2, danger: 1 } },
        { text: "\"L'assassinat politique est condamnable.\"", effects: { reformiste: 2 } },
        { text: "\"Marat √©tait l'ami du peuple ! Vengeance !\"", effects: { radical: 2, danger: 1 } },
        { text: "\"Je garde mes opinions pour moi.\"", effects: { opportuniste: 2 } }
      ]
    },
    { id: 16, acte: 3, year: 1793, title: "La Terreur", icon: "üîí",
      text: "La loi des suspects permet d'arr√™ter quiconque semble \"ennemi de la libert√©\". La guillotine fonctionne tous les jours.",
      question: "Comment traverses-tu cette p√©riode ?",
      encart: "<strong>\"Suspect\" pouvait signifier n'importe quoi</strong> : ne pas porter la cocarde, avoir l'air triste...",
      choices: [
        { text: "\"Cette Terreur est une abomination !\"", effects: { royaliste: 2, danger: 2 } },
        { text: "\"C'est terrible, mais temporaire.\"", effects: { reformiste: 2 } },
        { text: "\"La Terreur est juste !\"", effects: { radical: 2 } },
        { text: "\"Je fais profil bas.\"", effects: { opportuniste: 2 } }
      ]
    },
    { id: 17, acte: 3, year: 1793, title: "La d√©christianisation", icon: "üåü",
      text: "Les √©glises sont ferm√©es ou transform√©es en temples de la Raison. Nouveau calendrier : nous sommes en l'an II.",
      question: "Dans ton village, l'√©glise a √©t√© saccag√©e. Comment r√©agis-tu ?",
      encart: "<strong>Le calendrier r√©publicain a dur√© 12 ans.</strong> Un seul jour de repos sur 10 !",
      choices: [
        { text: "\"Sacril√®ge ! Ils profanent la maison de Dieu !\"", effects: { royaliste: 2, danger: 1 } },
        { text: "\"C'est excessif. On peut √™tre r√©publicain et respecter la libert√© religieuse.\"", effects: { reformiste: 2 } },
        { text: "\"Excellent ! La religion est l'opium du peuple !\"", effects: { radical: 2 } },
        { text: "\"Je participe √† la f√™te pour ne pas me faire remarquer.\"", effects: { opportuniste: 2 } }
      ]
    },
    { id: 18, acte: 3, year: 1794, title: "La chute de Robespierre", icon: "üî•",
      text: "9 thermidor (27 juillet 1794). Robespierre est accus√© de tyrannie, arr√™t√©, et guillotin√© le lendemain. La Terreur est finie.",
      question: "Comment accueilles-tu cette nouvelle ?",
      encart: "<strong>Robespierre reste controvers√©.</strong> H√©ros pour certains (suffrage universel), tyran pour d'autres.",
      choices: [
        { text: "\"Bon d√©barras ! Maintenant, r√©tablissons le roi !\"", effects: { royaliste: 2 } },
        { text: "\"La Terreur est finie ! La R√©publique peut respirer !\"", effects: { reformiste: 2 } },
        { text: "\"C'est un coup d'√âtat des corrompus !\"", effects: { radical: 2, danger: 2 } },
        { text: "\"Je danse avec tout le monde. Hier, j'applaudissais Robespierre...\"", effects: { opportuniste: 2 } }
      ]
    },
    // ACTE IV
    { id: 19, acte: 4, year: 1795, title: "La r√©action thermidorienne", icon: "üíÉ",
      text: "Les prisons se vident. Les \"muscadins\" traquent les anciens terroristes. Les bals reprennent, les riches affichent leur fortune.",
      question: "Comment vis-tu ce changement ?",
      encart: "<strong>Les \"Bals des victimes\"</strong> : pour y entrer, il fallait avoir eu un proche guillotin√© !",
      choices: [
        { text: "\"Enfin le retour √† l'ordre. Vivement le roi !\"", effects: { royaliste: 2 } },
        { text: "\"La Terreur √©tait excessive, mais cette vengeance aussi.\"", effects: { reformiste: 2 } },
        { text: "\"C'est √©c≈ìurant ! Les riches reprennent le pouvoir !\"", effects: { radical: 2, danger: 1 } },
        { text: "\"J'adapte ma garde-robe et je fr√©quente les salons.\"", effects: { opportuniste: 2 } }
      ]
    },
    { id: 20, acte: 4, year: 1795, title: "Le Directoire", icon: "üé∞",
      text: "Le Directoire prend le pouvoir : 5 directeurs, suffrage censitaire. R√©gime faible, corrompu, menac√© par royalistes et jacobins.",
      question: "Que penses-tu de ce r√©gime ?",
      encart: "<strong>Mais c'est aussi une p√©riode de progr√®s</strong> : √âcole polytechnique, syst√®me m√©trique...",
      choices: [
        { text: "\"Cette R√©publique est ill√©gitime. Restaurons la monarchie !\"", effects: { royaliste: 2 } },
        { text: "\"C'est imparfait, mais mieux que la Terreur.\"", effects: { reformiste: 2 } },
        { text: "\"Ce r√©gime ne sert que les riches !\"", effects: { radical: 2 } },
        { text: "\"Je cherche √† me faire des relations parmi les puissants.\"", effects: { opportuniste: 2 } }
      ]
    },
    { id: 21, acte: 4, year: 1797, title: "Bonaparte et les conqu√™tes", icon: "ü¶Ö",
      text: "Un g√©n√©ral de 27 ans, Napol√©on Bonaparte, √©crase les Autrichiens en Italie. Sa gloire est immense. En 1798, il part pour l'√âgypte.",
      question: "Que penses-tu de ce g√©n√©ral ?",
      encart: "<strong>Bonaparte a pill√© l'Italie :</strong> des centaines d'≈ìuvres sont encore au Louvre !",
      choices: [
        { text: "\"Encore un militaire ambitieux...\"", effects: { royaliste: 1, reformiste: 1 } },
        { text: "\"Il d√©fend la R√©publique ! C'est un h√©ros !\"", effects: { reformiste: 2 } },
        { text: "\"C'est un aventurier dangereux.\"", effects: { radical: 2 } },
        { text: "\"Voil√† l'homme qu'il nous faut pour l'ordre !\"", effects: { opportuniste: 2 } }
      ]
    },
    // ACTE V
    { id: 22, acte: 5, year: 1799, title: "Le coup d'√âtat du 18 Brumaire", icon: "üé≠",
      text: "9 novembre 1799. Bonaparte renverse le Directoire. Les d√©put√©s sont chass√©s. \"Citoyens, la R√©volution est finie.\"",
      question: "Comment accueilles-tu ce coup d'√âtat ?",
      encart: "<strong>Le coup d'√âtat a failli √©chouer !</strong> C'est son fr√®re Lucien qui a sauv√© Bonaparte.",
      choices: [
        { text: "\"C'est un dictateur ! Il a trahi la R√©publique !\"", effects: { radical: 2, danger: 1 } },
        { text: "\"Bonaparte va r√©tablir l'ordre sans renoncer √† 1789.\"", effects: { reformiste: 2 } },
        { text: "\"Excellent ! C'est le premier pas vers le retour du roi !\"", effects: { royaliste: 2 } },
        { text: "\"Enfin un homme fort !\"", effects: { opportuniste: 2 } }
      ]
    },
    { id: 23, acte: 5, year: 1801, title: "Le Concordat", icon: "‚õ™",
      text: "Bonaparte n√©gocie avec le pape. Le catholicisme est reconnu. Les pr√™tres sont pay√©s par l'√âtat. La paix religieuse revient.",
      question: "Comment vois-tu ce Concordat ?",
      encart: "<strong>Le Concordat a dur√© plus d'un si√®cle</strong> (jusqu'en 1905).",
      choices: [
        { text: "\"Dieu soit lou√© ! L'√âglise retrouve sa place !\"", effects: { royaliste: 2 } },
        { text: "\"C'est un bon compromis : paix religieuse et libert√©.\"", effects: { reformiste: 2 } },
        { text: "\"Quelle trahison ! Ramener les cur√©s !\"", effects: { radical: 2 } },
        { text: "\"Je retourne √† la messe publiquement. C'est prudent.\"", effects: { opportuniste: 2 } }
      ]
    },
    { id: 24, acte: 5, year: 1804, title: "Le Code civil", icon: "üìñ",
      text: "Bonaparte promulgue le Code civil : √©galit√© devant la loi, libert√© de conscience, droit de propri√©t√©. Mais la femme est sous tutelle du mari.",
      question: "Que penses-tu de ce Code ?",
      encart: "<strong>Le Code civil est encore en vigueur aujourd'hui !</strong> Il a influenc√© le monde entier.",
      choices: [
        { text: "\"C'est un progr√®s, mais l'in√©galit√© homme-femme est injuste !\"", effects: { radical: 1, reformiste: 1 } },
        { text: "\"Excellent ! √âgalit√© devant la loi, propri√©t√© garantie : voil√† 1789 !\"", effects: { reformiste: 2 } },
        { text: "\"Ce Code d√©truit les traditions.\"", effects: { royaliste: 2 } },
        { text: "\"Un code uniforme, c'est pratique pour les affaires.\"", effects: { opportuniste: 2 } }
      ]
    },
    { id: 25, acte: 5, year: 1804, title: "Le sacre de Napol√©on", icon: "üëë",
      text: "2 d√©cembre 1804. Napol√©on est sacr√© Empereur. Il prend la couronne et se la pose lui-m√™me sur la t√™te.",
      question: "Comment as-tu vot√© au pl√©biscite ?",
      encart: "<strong>Napol√©on cr√©e une nouvelle noblesse</strong> et distribue des titres. Fin de l'id√©al d'√©galit√© r√©publicaine.",
      choices: [
        { text: "\"J'ai vot√© non ! Un empereur, c'est un roi !\"", effects: { radical: 2, danger: 1 } },
        { text: "\"J'ai vot√© oui. Bonaparte a stabilis√© la France.\"", effects: { reformiste: 2 } },
        { text: "\"J'ai vot√© non. Le seul souverain l√©gitime est le roi Bourbon !\"", effects: { royaliste: 2, danger: 1 } },
        { text: "\"J'ai vot√© oui, comme tout le monde. C'est prudent.\"", effects: { opportuniste: 2 } }
      ]
    },
    { id: 26, acte: 5, year: 1807, title: "L'apog√©e de l'Empire", icon: "üåç",
      text: "1805-1810. Austerlitz, I√©na, Friedland... Napol√©on domine l'Europe. Mais la conscription et le blocus continental √©puisent la France.",
      question: "Comment vis-tu ces ann√©es ?",
      encart: "<strong>Les guerres napol√©oniennes ont fait entre 3 et 6 millions de morts.</strong>",
      choices: [
        { text: "\"Ces victoires m'indiff√®rent. Napol√©on reste un usurpateur.\"", effects: { royaliste: 2 } },
        { text: "\"La France domine l'Europe ! Mais √† quel prix humain...\"", effects: { reformiste: 2 } },
        { text: "\"Ces guerres ne servent qu'√† la gloire d'un seul homme !\"", effects: { radical: 2 } },
        { text: "\"Vive l'Empereur ! J'ai son portrait chez moi !\"", effects: { opportuniste: 2 } }
      ]
    },
    { id: 27, acte: 5, year: 1812, title: "La campagne de Russie", icon: "‚ùÑÔ∏è",
      text: "√ât√© 1812. Napol√©on envahit la Russie avec 600 000 hommes. Moscou est vide et en flammes. La retraite est une catastrophe. Seuls 30 000 reviennent.",
      question: "Comment r√©agis-tu ?",
      encart: "<strong>C'est l'une des pires catastrophes militaires de l'histoire.</strong> Temp√©ratures jusqu'√† -30¬∞C.",
      choices: [
        { text: "\"C'est la punition divine ! Ce tyran va tomber !\"", effects: { royaliste: 2 } },
        { text: "\"Quel d√©sastre... Tant de morts pour la folie d'un seul.\"", effects: { reformiste: 2 } },
        { text: "\"C'est la faute des g√©n√©raux, pas de l'Empereur !\"", effects: { opportuniste: 2 } },
        { text: "\"Il faut n√©gocier la paix maintenant.\"", effects: { reformiste: 1, opportuniste: 1 } }
      ]
    },
    // ACTE VI
    { id: 28, acte: 6, year: 1815, title: "Les Cent-Jours et Waterloo", icon: "‚öîÔ∏è",
      text: "Mars 1815. Napol√©on s'√©chappe de l'Elbe. Les soldats le rejoignent ! Louis XVIII fuit. Mais √† Waterloo, c'est la d√©faite. Exil √† Sainte-H√©l√®ne.",
      question: "Dans quel camp t'es-tu rang√© ?",
      encart: "<strong>En 20 jours, sans tirer un coup de feu, Napol√©on reconquiert son empire !</strong>",
      choices: [
        { text: "\"J'ai suivi le roi en exil.\"", effects: { royaliste: 2 } },
        { text: "\"J'ai ralli√© l'Empereur ! Il promettait une constitution !\"", effects: { reformiste: 2 } },
        { text: "\"Choisir entre le roi et le tyran ? Peste ou chol√©ra.\"", effects: { radical: 2 } },
        { text: "\"J'ai applaudi le roi, puis l'Empereur, puis le roi...\"", effects: { opportuniste: 2 } }
      ]
    },
    { id: 29, acte: 6, year: 1821, title: "La mort de Napol√©on et le bilan", icon: "‚ö∞Ô∏è",
      text: "5 mai 1821. Napol√©on meurt √† Sainte-H√©l√®ne. Louis XVIII r√®gne. Mais le Code civil demeure, l'√©galit√© devant la loi aussi.",
      question: "Quel bilan tires-tu de ces 32 ann√©es ?",
      encart: "<strong>La R√©volution fran√ßaise a chang√© le monde √† jamais.</strong> Ses id√©es continuent de nous inspirer.",
      choices: [
        { text: "\"Trente ans de chaos. Si seulement on avait gard√© l'Ancien R√©gime...\"", effects: { royaliste: 2 } },
        { text: "\"La R√©volution a pos√© les bases d'une soci√©t√© plus juste.\"", effects: { reformiste: 2 } },
        { text: "\"La R√©volution a √©t√© trahie par les bourgeois et Bonaparte.\"", effects: { radical: 2 } },
        { text: "\"J'ai surv√©cu. Ma famille a surv√©cu. C'est l'essentiel.\"", effects: { opportuniste: 2 } }
      ]
    }
];

const quizzes = {
    1: { title: "Quiz - Acte I", subtitle: "La fin de l'Ancien R√©gime", questions: [
        { question: "Pourquoi le Tiers-√âtat refusait-il le vote \"par ordre\" ?", options: ["Les d√©put√©s ne savaient pas compter", "Clerg√© + Noblesse gagneraient toujours 2 contre 1", "Le roi l'avait interdit", "C'√©tait trop long"], correct: 1 },
        { question: "Que symbolisait la Bastille ?", options: ["La richesse du roi", "La puissance de l'arm√©e", "L'arbitraire royal", "Le tr√©sor royal"], correct: 2 },
        { question: "Qu'a-t-on aboli la nuit du 4 ao√ªt ?", options: ["La monarchie", "Les privil√®ges", "La religion", "L'Assembl√©e"], correct: 1 },
        { question: "Selon l'article 1 de la DDHC, sur quoi les diff√©rences peuvent-elles √™tre fond√©es ?", options: ["La naissance", "L'utilit√© commune", "La richesse", "La religion"], correct: 1 }
    ]},
    2: { title: "Quiz - Acte II", subtitle: "La monarchie constitutionnelle", questions: [
        { question: "Pourquoi les femmes ont-elles march√© sur Versailles ?", options: ["Pour voir le ch√¢teau", "Pour r√©clamer du pain", "Pour le droit de vote", "Pour une f√™te"], correct: 1 },
        { question: "Qu'est-ce qui a divis√© le clerg√© ?", options: ["Le salaire", "Le serment √† la Nation", "Les v√™tements", "Le choix du pape"], correct: 1 },
        { question: "Pourquoi Varennes est-il un tournant ?", options: ["Le roi a r√©ussi √† fuir", "Le roi a prouv√© qu'il rejetait la R√©volution", "La reine a √©t√© arr√™t√©e", "L'Assembl√©e a √©t√© dissoute"], correct: 1 },
        { question: "Qui s'est oppos√© √† la guerre en 1792 ?", options: ["Louis XVI", "La Fayette", "Robespierre", "Marie-Antoinette"], correct: 2 }
    ]},
    3: { title: "Quiz - Acte III", subtitle: "La R√©publique et la Terreur", questions: [
        { question: "Qu'est-ce qui a provoqu√© la chute de la monarchie le 10 ao√ªt ?", options: ["Varennes", "Le manifeste de Brunswick et l'assaut des Tuileries", "L'assassinat de Marat", "Valmy"], correct: 1 },
        { question: "Pourquoi les Vend√©ens se sont-ils r√©volt√©s ?", options: ["Pour des augmentations", "Pour les Girondins", "Pour leur religion et contre la lev√©e en masse", "Pour l'ind√©pendance"], correct: 2 },
        { question: "Que permettait la loi des suspects ?", options: ["Lib√©rer les prisonniers", "Arr√™ter quiconque semblait ennemi", "√âlire les juges", "Prot√©ger les accus√©s"], correct: 1 },
        { question: "Que s'est-il pass√© le 9 Thermidor ?", options: ["Prise de la Bastille", "Ex√©cution du roi", "Chute de Robespierre", "D√©claration de guerre"], correct: 2 }
    ]},
    4: { title: "Quiz - Acte IV", subtitle: "La R√©publique bourgeoise", questions: [
        { question: "Qu'est-ce que la r√©action thermidorienne ?", options: ["Une r√©volution populaire", "La r√©pression des anciens terroristes", "Une invention", "Une r√©forme √©conomique"], correct: 1 },
        { question: "Comment fonctionnait le Directoire ?", options: ["Un seul dirigeant", "Le roi et une assembl√©e", "Cinq directeurs", "Vote direct du peuple"], correct: 2 },
        { question: "Quel √©tait le probl√®me du Directoire ?", options: ["Trop populaire", "Faible et corrompu", "Pas assez de guerres", "Imp√¥ts trop bas"], correct: 1 },
        { question: "Pourquoi Bonaparte √©tait-il populaire ?", options: ["Il a r√©tabli le roi", "Ses victoires en Italie", "Il a aboli les imp√¥ts", "Il a invent√© le syst√®me m√©trique"], correct: 1 }
    ]},
    5: { title: "Quiz - Acte V", subtitle: "Le Consulat et l'Empire", questions: [
        { question: "Que s'est-il pass√© le 18 Brumaire ?", options: ["Prise de la Bastille", "Coup d'√âtat de Bonaparte", "Sacre de Napol√©on", "Waterloo"], correct: 1 },
        { question: "Qu'est-ce que le Concordat de 1801 ?", options: ["Paix avec l'Angleterre", "Accord avec le pape", "Constitution r√©publicaine", "Trait√© commercial"], correct: 1 },
        { question: "Pourquoi le Code civil est-il important ?", options: ["R√©tablit les privil√®ges", "Unifie le droit et l'√©galit√©", "Donne le vote aux femmes", "Abolit la propri√©t√©"], correct: 1 },
        { question: "R√©sultat de la campagne de Russie ?", options: ["Grande victoire", "Catastrophe : moins de 100 000 survivants", "Match nul", "Annexion de la Russie"], correct: 1 }
    ]},
    6: { title: "Quiz Final", subtitle: "√âpilogue", questions: [
        { question: "Pourquoi les soldats ont-ils rejoint Napol√©on en 1815 ?", options: ["Ils avaient peur", "Mal pay√©s par le roi", "Fid√®les √† leur empereur", "Menac√©s par Napol√©on"], correct: 2 },
        { question: "O√π Napol√©on est-il mort ?", options: ["Paris", "√éle d'Elbe", "Waterloo", "Sainte-H√©l√®ne"], correct: 3 },
        { question: "Quel h√©ritage durable de la R√©volution ?", options: ["Pouvoir absolu du roi", "Privil√®ges de la noblesse", "√âgalit√© devant la loi", "Interdiction de la religion"], correct: 2 },
        { question: "Quand le corps de Napol√©on a-t-il √©t√© ramen√© en France ?", options: ["1821", "1830", "1840", "1870"], correct: 2 }
    ]}
};

const profiles = {
    royaliste: { name: "Royaliste conservateur", emoji: "üëë", motto: "Dieu, le Roi, la Tradition", color: "royaliste",
        description: "Tu as travers√© cette p√©riode comme un cauchemar. Pour toi, l'ordre ancien √©tait voulu par Dieu.",
        figures: "Louis XVI, Marie-Antoinette, les chefs vend√©ens" },
    reformiste: { name: "R√©formiste mod√©r√©", emoji: "‚öñÔ∏è", motto: "Libert√© et Ordre", color: "reformiste",
        description: "Tu incarnes l'esprit de 1789 : les Lumi√®res, les droits de l'homme. Mais tu voulais une r√©volution ordonn√©e.",
        figures: "La Fayette, Mirabeau, Condorcet" },
    radical: { name: "R√©volutionnaire radical", emoji: "‚úä", motto: "Libert√©, √âgalit√© ou la Mort", color: "radical",
        description: "Pour toi, la R√©volution devait transformer la soci√©t√©. Pas seulement l'√©galit√© en droits, mais l'√©galit√© r√©elle !",
        figures: "Robespierre, Marat, Saint-Just" },
    opportuniste: { name: "Opportuniste pragmatique", emoji: "üé≠", motto: "Survivre et prosp√©rer", color: "opportuniste",
        description: "Tu as navigu√© habilement. Royaliste en 1789, patriote en 1792, bonapartiste en 1799... Tu as su t'adapter.",
        figures: "Talleyrand, Fouch√©, Barras" }
};

let gameState = {
    character: {},
    scores: { royaliste: 0, reformiste: 0, radical: 0, opportuniste: 0, danger: 0, notoriete: 0, savoir: 0 },
    currentSituation: 0,
    currentQuizActe: 1,
    currentQuestionIndex: 0,
    quizAnswers: []
};

document.getElementById('startBtn').addEventListener('click', function() {
    document.getElementById('introScreen').classList.add('hidden');
    document.getElementById('characterScreen').classList.remove('hidden');
});

document.getElementById('beginBtn').addEventListener('click', function() {
    gameState.character = {
        nom: document.getElementById('charNom').value || "Inconnu",
        prenom: document.getElementById('charPrenom').value || "Jean",
        ordre: document.getElementById('charOrdre').value || "Tiers-√âtat",
        metier: document.getElementById('charMetier').value || "Citoyen",
        lieu: document.getElementById('charLieu').value || "Paris"
    };
    document.getElementById('characterScreen').classList.add('hidden');
    document.getElementById('gameScreen').classList.remove('hidden');
    document.getElementById('scoreBar').classList.remove('hidden');
    renderSituation();
});

document.getElementById('closeEncart').addEventListener('click', function() {
    document.getElementById('encartModal').classList.add('hidden');
    nextSituation();
});

document.getElementById('continueBtn').addEventListener('click', function() {
    document.getElementById('encartModal').classList.add('hidden');
    nextSituation();
});

function renderSituation() {
    const situation = situations[gameState.currentSituation];
    const acte = actes.find(a => a.id === situation.acte);
    const progress = ((gameState.currentSituation + 1) / situations.length) * 100;
    document.getElementById('progressFill').style.width = progress + '%';
    document.getElementById('progressText').textContent = 'Situation ' + (gameState.currentSituation + 1) + ' / ' + situations.length + ' ‚Äî Acte ' + acte.id + ': ' + acte.nom;
    
    let html = '<div class="situation-header"><div><div class="situation-year">' + situation.year + '</div><div class="situation-acte">Acte ' + acte.id + ' ‚Ä¢ ' + acte.periode + '</div></div><div class="situation-icon">' + situation.icon + '</div></div>';
    html += '<div class="situation-body"><h2 class="situation-title">' + situation.title + '</h2>';
    html += '<div class="situation-text">' + addTooltips(situation.text).replace(/\n/g, '<br>') + '</div>';
    
    // Bouton En savoir plus (si disponible)
    if (situation.savoirPlus) {
        html += '<button class="btn-savoir-plus" id="btnSavoirPlus">üìö En savoir plus sur cette p√©riode</button>';
    }
    
    html += '<p class="situation-question">' + situation.question + '</p>';
    html += '<div class="choices-container" id="choicesContainer"></div></div>';
    document.getElementById('situationCard').innerHTML = html;
    
    // Event listener pour En savoir plus
    if (situation.savoirPlus) {
        document.getElementById('btnSavoirPlus').addEventListener('click', function() {
            document.getElementById('savoirPlusTitle').textContent = situation.title;
            document.getElementById('savoirPlusBody').innerHTML = situation.savoirPlus;
            document.getElementById('savoirPlusModal').classList.remove('hidden');
        });
    }
    
    const container = document.getElementById('choicesContainer');
    situation.choices.forEach(function(choice, index) {
        const btn = document.createElement('button');
        btn.className = 'choice-btn';
        btn.textContent = choice.text;
        btn.addEventListener('click', function() { makeChoice(index); });
        container.appendChild(btn);
    });
    updateScoreDisplay();
}

function makeChoice(choiceIndex) {
    const situation = situations[gameState.currentSituation];
    const choice = situation.choices[choiceIndex];
    if (choice.effects) {
        Object.keys(choice.effects).forEach(function(key) {
            if (gameState.scores.hasOwnProperty(key)) {
                gameState.scores[key] += choice.effects[key];
            }
        });
    }
    updateScoreDisplay();
    if (situation.encart) {
        document.getElementById('encartBody').innerHTML = '<p>' + situation.encart + '</p>';
        document.getElementById('encartModal').classList.remove('hidden');
    } else {
        nextSituation();
    }
}

function nextSituation() {
    const currentSituation = situations[gameState.currentSituation];
    const nextSituationData = situations[gameState.currentSituation + 1];
    
    if (nextSituationData && currentSituation.acte !== nextSituationData.acte) {
        showQuiz(currentSituation.acte);
    } else if (gameState.currentSituation < situations.length - 1) {
        gameState.currentSituation++;
        renderSituation();
        window.scrollTo(0, 0);
    } else {
        showQuiz(6);
    }
}

function showQuiz(acteId) {
    const quiz = quizzes[acteId];
    gameState.quizAnswers = [];
    gameState.currentQuizActe = acteId;
    gameState.currentQuestionIndex = 0;
    document.getElementById('gameScreen').classList.add('hidden');
    document.getElementById('quizScreen').classList.remove('hidden');
    document.getElementById('quizTitle').textContent = quiz.title;
    document.getElementById('quizSubtitle').textContent = quiz.subtitle;
    renderQuizQuestion();
}

function renderQuizQuestion() {
    const quiz = quizzes[gameState.currentQuizActe];
    if (gameState.currentQuestionIndex >= quiz.questions.length) {
        showQuizResults();
        return;
    }
    const q = quiz.questions[gameState.currentQuestionIndex];
    let html = '<div style="text-align:center;"><p style="margin-bottom:0.5rem;color:var(--sepia);">Question ' + (gameState.currentQuestionIndex + 1) + ' / ' + quiz.questions.length + '</p>';
    html += '<p class="quiz-question">' + q.question + '</p><div class="quiz-options" id="quizOptions"></div></div>';
    document.getElementById('quizContent').innerHTML = html;
    
    const container = document.getElementById('quizOptions');
    q.options.forEach(function(opt, i) {
        const btn = document.createElement('button');
        btn.className = 'quiz-option';
        btn.textContent = opt;
        btn.addEventListener('click', function() { answerQuiz(i); });
        container.appendChild(btn);
    });
}

function answerQuiz(answerIndex) {
    const quiz = quizzes[gameState.currentQuizActe];
    const q = quiz.questions[gameState.currentQuestionIndex];
    const isCorrect = answerIndex === q.correct;
    if (isCorrect) {
        gameState.scores.savoir++;
        gameState.quizAnswers.push(true);
    } else {
        gameState.quizAnswers.push(false);
    }
    
    const buttons = document.querySelectorAll('.quiz-option');
    buttons.forEach(function(btn, i) {
        btn.disabled = true;
        if (i === q.correct) btn.classList.add('correct');
        else if (i === answerIndex && !isCorrect) btn.classList.add('incorrect');
    });
    
    setTimeout(function() {
        gameState.currentQuestionIndex++;
        renderQuizQuestion();
    }, 1200);
    updateScoreDisplay();
}

function showQuizResults() {
    const correctCount = gameState.quizAnswers.filter(function(a) { return a; }).length;
    let feedbackClass, feedbackText;
    if (correctCount >= 4) { feedbackClass = 'excellent'; feedbackText = 'üèÜ Excellent !'; }
    else if (correctCount >= 3) { feedbackClass = 'good'; feedbackText = 'üëç Bien jou√© !'; }
    else { feedbackClass = 'retry'; feedbackText = '‚ö†Ô∏è Relis les encarts !'; }
    
    let html = '<div class="quiz-score">Score : ' + correctCount + ' / 4</div>';
    html += '<div class="quiz-feedback ' + feedbackClass + '">' + feedbackText + '</div>';
    html += '<div style="text-align:center;margin-top:2rem;">';
    
    if (gameState.currentQuizActe === 6) {
        html += '<button class="btn-primary" id="showEndBtn">Voir mes r√©sultats finaux</button>';
    } else {
        html += '<button class="btn-primary" id="continueQuizBtn">Continuer l\'aventure</button>';
    }
    html += '</div>';
    document.getElementById('quizContent').innerHTML = html;
    
    if (gameState.currentQuizActe === 6) {
        document.getElementById('showEndBtn').addEventListener('click', showEndScreen);
    } else {
        document.getElementById('continueQuizBtn').addEventListener('click', function() {
            gameState.currentSituation++;
            document.getElementById('quizScreen').classList.add('hidden');
            document.getElementById('gameScreen').classList.remove('hidden');
            renderSituation();
            window.scrollTo(0, 0);
        });
    }
}

function showEndScreen() {
    document.getElementById('quizScreen').classList.add('hidden');
    document.getElementById('scoreBar').classList.add('hidden');
    document.getElementById('endScreen').classList.remove('hidden');
    
    const royaliste = gameState.scores.royaliste;
    const reformiste = gameState.scores.reformiste;
    const radical = gameState.scores.radical;
    const opportuniste = gameState.scores.opportuniste;
    const max = Math.max(royaliste, reformiste, radical, opportuniste);
    let dominantKey = 'opportuniste';
    if (royaliste === max) dominantKey = 'royaliste';
    else if (reformiste === max) dominantKey = 'reformiste';
    else if (radical === max) dominantKey = 'radical';
    
    const dominant = profiles[dominantKey];
    
    let endHTML = '<div class="result-card"><h1 class="result-title">Fin de l\'aventure</h1>';
    endHTML += '<div class="character-recap"><strong>' + gameState.character.prenom + ' ' + gameState.character.nom + '</strong><br>' + gameState.character.metier + ' ‚Ä¢ ' + gameState.character.ordre + ' ‚Ä¢ ' + gameState.character.lieu + '</div></div>';
    
    endHTML += '<div class="parchment-box"><h2 class="section-title" style="margin-bottom:1.5rem;">Tes scores</h2>';
    endHTML += '<div class="scores-grid">';
    endHTML += '<div class="score-card royaliste"><div class="score-card-emoji">üëë</div><div class="score-card-label">Royaliste</div><div class="score-card-value">' + gameState.scores.royaliste + '</div></div>';
    endHTML += '<div class="score-card reformiste"><div class="score-card-emoji">‚öñÔ∏è</div><div class="score-card-label">R√©formiste</div><div class="score-card-value">' + gameState.scores.reformiste + '</div></div>';
    endHTML += '<div class="score-card radical"><div class="score-card-emoji">‚úä</div><div class="score-card-label">Radical</div><div class="score-card-value">' + gameState.scores.radical + '</div></div>';
    endHTML += '<div class="score-card opportuniste"><div class="score-card-emoji">üé≠</div><div class="score-card-label">Opportuniste</div><div class="score-card-value">' + gameState.scores.opportuniste + '</div></div>';
    endHTML += '</div>';
    endHTML += '<div class="knowledge-result">üìö <span>Connaissances : ' + gameState.scores.savoir + ' / 24</span></div></div>';
    
    endHTML += '<div class="profile-result ' + dominant.color + '">';
    endHTML += '<h2 style="font-family:Cinzel,serif;font-size:1rem;opacity:0.8;margin-bottom:1rem;">TON PROFIL DOMINANT</h2>';
    endHTML += '<div class="profile-emoji">' + dominant.emoji + '</div>';
    endHTML += '<div class="profile-name">' + dominant.name + '</div>';
    endHTML += '<p style="font-style:italic;margin-bottom:1.5rem;"><em>"' + dominant.motto + '"</em></p>';
    endHTML += '<p class="profile-description">' + dominant.description + '</p>';
    endHTML += '<p style="margin-top:1.5rem;"><strong>Personnages historiques qui te ressemblent :</strong> ' + dominant.figures + '</p></div>';
    
    endHTML += '<div class="heritage-box"><h3 class="heritage-title">Ce qu\'il reste de la R√©volution</h3>';
    endHTML += '<ul class="heritage-list">';
    endHTML += '<li><span>üèõÔ∏è</span><span>La R√©publique et la souverainet√© nationale</span></li>';
    endHTML += '<li><span>‚öñÔ∏è</span><span>L\'√©galit√© devant la loi (Code civil)</span></li>';
    endHTML += '<li><span>üìú</span><span>Les droits de l\'homme (DDHC de 1789)</span></li>';
    endHTML += '<li><span>üá´üá∑</span><span>Le drapeau tricolore, La Marseillaise, le 14 juillet</span></li>';
    endHTML += '</ul>';
    endHTML += '<p style="text-align:center;margin-top:1.5rem;font-style:italic;color:var(--sepia);">La R√©volution fran√ßaise a chang√© le monde.<br>Et toi, tu viens de la vivre.</p></div>';
    
    endHTML += '<div style="text-align:center;margin-top:2rem;"><button class="btn-primary" onclick="location.reload()">Rejouer</button></div>';
    
    document.getElementById('endScreen').innerHTML = endHTML;
    window.scrollTo(0, 0);
}

function updateScoreDisplay() {
    // Valeur max pour calculer le pourcentage des jauges (bas√© sur le score max th√©orique)
    const maxScore = 40; // Score max approximatif par cat√©gorie
    const maxDanger = 20; // Score danger max approximatif
    
    // Mettre √† jour les valeurs num√©riques
    document.getElementById('scoreRoyaliste').textContent = gameState.scores.royaliste;
    document.getElementById('scoreReformiste').textContent = gameState.scores.reformiste;
    document.getElementById('scoreRadical').textContent = gameState.scores.radical;
    document.getElementById('scoreOpportuniste').textContent = gameState.scores.opportuniste;
    document.getElementById('scoreDanger').textContent = gameState.scores.danger;
    document.getElementById('scoreSavoir').textContent = gameState.scores.savoir;
    
    // Mettre √† jour les jauges (pourcentage)
    document.getElementById('gaugeRoyaliste').style.width = Math.min(100, (gameState.scores.royaliste / maxScore) * 100) + '%';
    document.getElementById('gaugeReformiste').style.width = Math.min(100, (gameState.scores.reformiste / maxScore) * 100) + '%';
    document.getElementById('gaugeRadical').style.width = Math.min(100, (gameState.scores.radical / maxScore) * 100) + '%';
    document.getElementById('gaugeOpportuniste').style.width = Math.min(100, (gameState.scores.opportuniste / maxScore) * 100) + '%';
    document.getElementById('gaugeDanger').style.width = Math.min(100, (gameState.scores.danger / maxDanger) * 100) + '%';
}

document.getElementById('encartModal').addEventListener('click', function(e) {
    if (e.target === this) {
        this.classList.add('hidden');
        nextSituation();
    }
});

// Event listeners pour la modal En savoir plus
document.getElementById('closeSavoirPlus').addEventListener('click', function() {
    document.getElementById('savoirPlusModal').classList.add('hidden');
});

document.getElementById('closeSavoirPlusBtn').addEventListener('click', function() {
    document.getElementById('savoirPlusModal').classList.add('hidden');
});

document.getElementById('savoirPlusModal').addEventListener('click', function(e) {
    if (e.target === this) {
        this.classList.add('hidden');
    }
});
</script>
</body>
</html>
